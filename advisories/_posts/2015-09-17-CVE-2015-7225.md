---
layout: advisory
title: 'CVE-2015-7225 (devise-two-factor): devise-two-factor 1.1.0 and earlier vulnerable
  to replay attacks

'
comments: false
categories:
- devise-two-factor
advisory:
  gem: devise-two-factor
  cve: 2015-7225
  url: http://www.openwall.com/lists/oss-security/2015/09/06/2
  title: 'devise-two-factor 1.1.0 and earlier vulnerable to replay attacks

'
  date: 2015-09-17
  description: "A OTP replay vulnerability in devise-two-factor 1.1.0 and earlier
    allows local\nattackers to shoulder-surf a user's TOTP verification code and use
    it to\nlogin after the user has authenticated. \n\nBy not \"burning\" a previously
    used TOTP, devise-two-factor allows a narrow\nwindow of opportunity (aka the timestep
    period) where an attacker can re-use a\nverification code. \n\nShould an attacker
    possess a given user's authentication \ncredentials, this flaw effectively defeats
    two-factor authentication for the \nduration of the timestep. \n"
  patched_versions:
  - ">= 2.0.0"
---
